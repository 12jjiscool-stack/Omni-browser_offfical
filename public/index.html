<!-- Hidden YouTube Lofi Player -->
<div id="yt-player" style="display:none;"></div>

<script>
  let ytPlayer;

  function onYouTubeIframeAPIReady() {
    ytPlayer = new YT.Player("yt-player", {
      height: "0",
      width: "0",
      videoId: "c9kIsJ15DsM", // The lofi track
      playerVars: {
        autoplay: 1,
        loop: 1,
        playlist: "c9kIsJ15DsM",
      },
      events: {
        onReady: (event) => {
          event.target.setVolume(20); // Start at 20% volume
          const musicMuted = localStorage.getItem("musicMuted");
          if (musicMuted === "true") {
            ytPlayer.mute();
            document.getElementById("toggleMusicBtn").textContent = "Unmute Music";
          }
        }
      }
    });
  }

  function toggleMusic() {
    const btn = document.getElementById("toggleMusicBtn");
    if (ytPlayer.isMuted()) {
      ytPlayer.unMute();
      btn.textContent = "Mute Music";
      localStorage.setItem("musicMuted", "false");
    } else {
      ytPlayer.mute();
      btn.textContent = "Unmute Music";
      localStorage.setItem("musicMuted", "true");
    }
  }

  // Load YouTube IFrame API
  const tag = document.createElement("script");
  tag.src = "https://www.youtube.com/iframe_api";
  document.body.appendChild(tag);
</script>
